My presentation script for my hard flag


Step One
- dowload pcap file and open it in wireshark.
- read The first hint to recieve clues as to what to do.
- Say, "Well lets state the obviouse here,... theyre obviously highlighting the word "domains",... and the fact that where dealing with a pcap file
  makes me think of DNS entires, so immeditalty im thinking of DNS protocol. So Maybe i should start with that.
lets go ahead and open up wireshark.
You can see that we have a total of 6,486 packets. Thats a lot! And it says that ther are 4 key words that we have to find in this flag, which more likley
than not each one will most likely exist in one singular packet. So Basicaly 4 needles in a hay stack. And There has to be a way to filter these 6,000 packets,
which of course there is. And where going to do that now. 
Lets start out small, lets try filtering for packets that used DNS protocol. lets type "dns" here.
boom now i can only see dns.
And  if you look down here you'll see its now only displaying 400 out of that 6486. So that helped!
lets look at the ip addresses,... and if you do,. it wont take long in general to notice that all the packets here in this pcap file are coming from 10.0.2.15. 
So it not like were looking at a range of different ip's communicating with each other. In this case, in this pcap file, they're all communincating back 
to 10.0.2.15. And thats also the case with this here with this DNS protocol that we just filtered and searched for.
And if you look at the "info section" you can look at all the "querys" that were made as well as the "query responses". 
And if im honest, if im looking to see what domains/websites the person is querying for then im not really intrested in what the responses are.
So Lets try and see if we can filter out the respones.
So lets click on any "response" packet look and see what is making it say the word "response".
.........demonstrate
You can see that it's assigned a "1",... so maybe if i changed it to a "0" and created a filter for it then maybe it will get rid of all the responses.
So lets lets right click on that,... and then click prepare as filter,... Notice and see that the filter says TRUE. I can either change it to make it say 
FALSE or i can change it to a 0. And once we apply the filter we get a noticible difference. Now it's displaying only 203 rather than the 400 we had before.
And notice how in the info section again we see a pattern where the packets will say either the letter "A" or "HTTPS" before specifying the domain name.
And you can also see another noticable pattern where the same domain name will be Reiterated with "https" every time a domain is reiterated with the 
Letter "A" preceeding before it. And because i dont want copies of the same quries being madee essentialy,.. im just going to go ahead and filter that
out,... and im going to start with https. So i have to figure out what is making it say "https",... its as easy as clicking on the packet, finding 
the area, and copy as filter. and there are two ways of doing this.
.........demonstrate
And now you can see that we have 118 packets rather than 203,... basically cutting it down in half twice.
and from here its as simple as scrolling down to see if we can hopefully find our flag potentialy.






Step 2
Lets go ahead and read the 2nd hint.
........Demonstrate
well to the unlearned person it doesnt seem like its highlighting any thing other than the fact that its talking about the subject of newspapers.
Somone whos already somewhat astute in network protocols and packets and etc will pretty much pick up what the hint is putting down. For us anyways
one things for sure is that im not going to do research on every single protocol to see if there is a connction with the hint. 
Maybe there is a way to at least narrow down my research? Your research doesnt Necessarily have to be about protocols, but it's a start.
For me i would look at the pcap file and make a list of all the protocols being used that i can see with wireshark. And more or less once your done
you will get a rather small handfull of protocols to research for. Eventually as you go down your list you will hit "NNTP" and start researching
that protocol, which a quick search will show that NNTP stands for "Network News Tramission Protocol". Even the name is a kind of a give away. 
Network news transmission protocol and then we have a hint that talks about newspapers. Seems like a correlation to me. And if you continue to research 
you will quickly learn that its a system that works along with usenet that emerged before the world wide web and it was pretty popular 
in the past, and youll learn that it somewhat diminished in use due to the rise of other online communication platforms. ANd just from from 
learning that it sounds extreamly similar to the hint that talkes about, "most people get there news from social media and etc, 
but my parents still read the newspaper." If i had to bet, NNTP is the protocol that we need to search for.
So lets go do that.
.........Demonstrate
Look at what we did,... we reduced it down to 26 packete out of 6000+ packets!
This is going to easy. 
And when looking at packets you dont just look at the protocol tab and the info tab. You also have to consider other tabs like the Length tab, 
whcich tells you how many bytes that are used to make up that packet.
.......Demonstrate
Here we have a packet that is 1488, and its typically normal for a packet to have bytes in the 150 or below range per say. SO seing these bigger 
packets likes these that are carrying 1000+ bytes is of intrest to me. It even says "article" next to it so its obviously carry information about 
article. And you can even see the readable words in ASCII if you look down at the bottom right. And by the way i just want to say now that this is
essentially a discussion forum were people can discuss revelent topics that were discussed in the podcast which is called SecurityNow. 
You can look them up on Youtube and and learn a lot. But maybe our Flag might be in here in one of these larger packets, So lets click on the one
that has 1176 bytes.
.........Demonstrate and reveal the Flag




Step 3







dns.qry.name == "www.FLAG---{IN}.com"
dns.flags.response == 0 and dns.qry.type == 1

ftp.response.code == 150

tcp.srcport == 119

tcp.dstport == 9999
tcp.dstport == 9999 or tcp.srcport ==9999

