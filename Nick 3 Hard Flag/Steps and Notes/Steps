My presentation script for my hard flag


Step One
- dowload pcap file and open it in wireshark.
- read The first hint to recieve clues as to what to do.
- Say, "Well lets state the obviouse here,... theyre obviously highlighting the word "domains",... and the fact that where dealing with a pcap file
  makes me think of DNS entires, so immeditalty im thinking of DNS protocol. So Maybe i should start with that.
lets go ahead and open up wireshark.
You can see that we have a total of 6,486 packets. Thats a lot! And it says that ther are 4 key words that we have to find in this flag, which more likley
than not each one will most likely exist in one singular packet. So Basicaly 4 needles in a hay stack. And There has to be a way to filter these 6,000 packets,
which of course there is. And where going to do that now. 
Lets start out small, lets try filtering for packets that used DNS protocol. lets type "dns" here.
boom now i can only see dns.
And  if you look down here you'll see its now only displaying 400 out of that 6486. So that helped!
lets look at the ip addresses,... and if you do,. it wont take long in general to notice that all the packets here in this pcap file are coming from 10.0.2.15. 
So it not like were looking at a range of different ip's communicating with each other. In this case, in this pcap file, they're all communincating back 
to 10.0.2.15. And thats also the case with this here with this DNS protocol that we just filtered and searched for.
And if you look at the "info section" you can look at all the "querys" that were made as well as the "query responses". 
And if im honest, if im looking to see what domains/websites the person is querying for then im not really intrested in what the responses are.
So Lets try and see if we can filter out the respones.
So lets click on any "response" packet look and see what is making it say the word "response".
.........demonstrate
You can see that it's assigned a "1",... so maybe if i changed it to a "0" and created a filter for it then maybe it will get rid of all the responses.
So lets lets right click on that,... and then click prepare as filter,... Notice and see that the filter says TRUE. I can either change it to make it say 
FALSE or i can change it to a 0. And once we apply the filter we get a noticible difference. Now it's displaying only 203 rather than the 400 we had before.
And notice how in the info section again we see a pattern where the packets will say either the letter "A" or "HTTPS" before specifying the domain name.
And you can also see another noticable pattern where the same domain name will be Reiterated with "https" every time a domain is reiterated with the 
Letter "A" preceeding before it. And because i dont want copies of the same quries being madee essentialy,.. im just going to go ahead and filter that
out,... and im going to start with https. So i have to figure out what is making it say "https",... its as easy as clicking on the packet, finding 
the area, and copy as filter. and there are two ways of doing this.
.........demonstrate
And now you can see that we have 118 packets rather than 203,... basically cutting it down in half twice.
and from here its as simple as scrolling down to see if we can hopefully find our flag potentialy.






Step 2
Lets go ahead and read the 2nd hint.
........Demonstrate
well to the unlearned person it doesnt seem like its highlighting any thing other than the fact that its talking about the subject of newspapers.
Somone whos already somewhat astute in network protocols and packets and etc will pretty much pick up what the hint is putting down. For us anyways
one things for sure is that im not going to do research on every single protocol to see if there is a connction with the hint. 
Maybe there is a way to at least narrow down my research? Your research doesnt Necessarily have to be about protocols, but it's a start.
For me i would look at the pcap file and make a list of all the protocols being used that i can see with wireshark. And more or less once your done
you will get a rather small handfull of protocols to research for. Eventually as you go down your list you will hit "NNTP" and start researching
that protocol, which a quick search will show that NNTP stands for "Network News Tramission Protocol". Even the name is a kind of a give away. 
Network news transmission protocol and then we have a hint that talks about newspapers. Seems like a correlation to me. And if you continue to research 
you will quickly learn that its a system that works along with usenet that emerged before the world wide web and it was pretty popular 
in the past, and youll learn that it somewhat diminished in use due to the rise of other online communication platforms. ANd just from from 
learning that it sounds extreamly similar to the hint that talkes about, "most people get there news from social media and etc, 
but my parents still read the newspaper." If i had to bet, NNTP is the protocol that we need to search for.
So lets go do that.
.........Demonstrate
Look at what we did,... we reduced it down to 26 packete out of 6000+ packets!
This is going to easy. 
And when looking at packets you dont just look at the protocol tab and the info tab. You also have to consider other tabs like the Length tab, 
whcich tells you how many bytes that are used to make up that packet.
.......Demonstrate
Here we have a packet that is 1488, and its typically normal for a packet to have bytes in the 150 or below range per say. SO seing these bigger 
packets likes these that are carrying 1000+ bytes is of intrest to me. It even says "article" next to it so its obviously carry information about 
article. And you can even see the readable words in ASCII if you look down at the bottom right. And by the way i just want to say now that this is
essentially a discussion forum were people can discuss revelent topics that were discussed in the podcast which is called SecurityNow. 
You can look them up on Youtube and and learn a lot. But maybe our Flag might be in here in one of these larger packets, So lets click on the one
that has 1176 bytes.
.........Demonstrate and reveal the Flag




Step 3
..........read the 3rd hint
Now from reading this,... the clues that i can derive from this would be about the fact that the subject revolves around Mail and letters. and also it
highlights the letters DEB in debit card. My first thought that come to mind is email, however there is no SMTP protocol thats exists in this pcap file.
Because if we look at our hypothetical list that we created earlier we'll see that it's not on that list. And out of all the protocols that are on that 
list FTP would be my highest contender due to the fact that it works with retrieveing and sending files That could be figuratively interpreted as
a letter. and im not sure if you already saw  but there was FTP protocol, and ther was FTP-DATA protocol that exists in that pcap file. And the very 
fact there is protocol by the name FTP_DATA in the pcap means somebody definetly must have transfered some data to or from their device.
So lets quickly type FTP-DATA to see more info from it
..........Demonstrate
And as you can see,... its the server that is the one thats sending data packets to the host,... which means the host is downloading a file of somekind
from the server. And i want to know what file that is,... and if you look over at the info section you'll see the name and type of that file, which
in this case is a .deb file,....Hmmmmm sounds eerily similar to the hint that spoke about the kid finding a DEB-it card. with the DEB being noticibly 
highlighted. but i'll tell you right now if you double click on any of these packets it's not going to reveal the flag. You have a total of 360 packets
being displayed and theyre all pretty much similar. So opening up each one to look for the flag seems rather time consuming. Maybe you can find a way to
filter for it, and feel free to correct me if im wrong, but i dont feel like there is.
So with that being said lets go back and create a filter for only FTP.
...........Demonstrate
we see that there are only 95 packets being displayed.
And as we can can see everything seems to be rather scattered all over the place,.. so letes see if there is a way to group some of information thats
being showed. So lets click on info, and boom its a little more easier to se better. Here we can see the requests being made. We can see all the attempts
to change the working directoy CWD, and we see we can see another group called requesting to LIST, and another that says to Print working Directory PWD.
And here we see a request to retrieve (RETR) a file which is the same file we saw earlier that was being downloaded earlier.
And if you scroll down a few packets more you can see the flag,... Monkeys.exe
At the time of creating this CTF i notice now that i could have done this differently.
and if i were to go back and do it again. i would have filtered out the responses and replace the location of the flag to replace the name of the file
that was making the request for that file.

Step 4







dns.qry.name == "www.FLAG---{IN}.com"
dns.flags.response == 0 and dns.qry.type == 1

ftp.response.code == 150

tcp.srcport == 119

tcp.dstport == 9999
tcp.dstport == 9999 or tcp.srcport ==9999

