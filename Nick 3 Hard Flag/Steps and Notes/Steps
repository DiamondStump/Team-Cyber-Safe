My presentation script for my hard flag


Step One
- dowload pcap file and open it in wireshark.
- read The first hint to recieve clues as to what to do.
- Say, "Well lets state the obviouse here,... theyre obviously highlighting the word "domains",... and the fact that where dealing with a pcap file
  makes me think of DNS entires, so immeditalty im thinking of DNS protocol. So Maybe i should start with that.
lets go ahead and open up wireshark.
You can see that we have a total of 6,486 packets. Thats a lot! And it says that ther are 4 key words that we have to find in this flag, which more likley
than not each one will most likely exist in one singular packet. So Basicaly 4 needles in a hay stack. And There has to be a way to filter these 6,000 packets,
which of course there is. And where going to do that now. 
Lets start out small, lets try filtering for packets that used DNS protocol. lets type "dns" here.
boom now i can only see dns.
And  if you look down here you'll see its now only displaying 400 out of that 6486. So that helped!
lets look at the ip addresses,... and if you do,. it wont take long in general to notice that all the packets here in this pcap file are coming from 10.0.2.15. 
So it not like were looking at a range of different ip's communicating with each other. In this case, in this pcap file, they're all communincating back 
to 10.0.2.15. And thats also the case with this here with this DNS protocol that we just filtered and searched for.
And if you look at the "info section" you can look at all the "querys" that were made as well as the "query responses". 
And if im honest, if im looking to see what domains/websites the person is querying for then im not really intrested in what the responses are.
So Lets try and see if we can filter out the respones.
So lets click on any "response" packet look and see what is making it say the word "response".
.........demonstrate
You can see that it's assigned a "1",... so maybe if i changed it to a "0" and created a filter for it then maybe it will get rid of all the responses.
So lets lets right click on that,... and then click prepare as filter,... Notice and see that the filter says TRUE. I can either change it to make it say 
FALSE or i can change it to a 0. And once we apply the filter we get a noticible difference. Now it's displaying only 203 rather than the 400 we had before.
And notice how in the info section again we see a pattern where the packets will say either the letter "A" or "HTTPS" before specifying the domain name.
And you can also see another noticable pattern where the same domain name will be Reiterated with "https" every time a domain is reiterated with the 
Letter "A" preceeding before it. And because i dont want copies of the same quries being madee essentialy,.. im just going to go ahead and filter that
out,... and im going to start with https. So i have to figure out what is making it say "https",... its as easy as clicking on the packet, finding 
the area, and copy as filter. and there are two ways of doing this.
.........demonstrate
And now you can see that we have 118 packets rather than 203,... basically cutting it down in half twice.
and from here its as simple as scrolling down to see if we can hopefully find our flag potentialy.






Step 2
Lets go ahead and read the 2nd hint.
........Demonstrate
well to the unlearned person it doesnt seem like its highlighting any thing other than the fact that its talking about the subject of newspapers.
Somone whos already somewhat astute in network protocols and packets and etc will pretty much pick up what the hint is putting down. For us anyways
one things for sure is that im not going to do research on every single protocol to see if there is a connction with the hint. 
Maybe there is a way to at least narrow down my research? Your research doesnt Necessarily have to be about protocols, but it's a start.
For me i would look at the pcap file and make a list of all the protocols being used that i can see with wireshark. And more or less once your done
you will get a rather small handfull of protocols to research for. Eventually as you go down your list you will hit "NNTP" and start researching
that protocol, which a quick search will show that NNTP stands for "Network News Tramission Protocol". Even the name is a kind of a give away. 
Network news transmission protocol and then we have a hint that talks about newspapers. Seems like a correlation to me. And if you continue to research 
you will quickly learn that its a system that works along with usenet that emerged before the world wide web and it was pretty popular 
in the past, and youll learn that it somewhat diminished in use due to the rise of other online communication platforms. ANd just from from 
learning that it sounds extreamly similar to the hint that talkes about, "most people get there news from social media and etc, 
but my parents still read the newspaper." If i had to bet, NNTP is the protocol that we need to search for.
So lets go do that.
.........Demonstrate
Look at what we did,... we reduced it down to 26 packete out of 6000+ packets!
This is going to easy. 
And when looking at packets you dont just look at the protocol tab and the info tab. You also have to consider other tabs like the Length tab, 
whcich tells you how many bytes that are used to make up that packet.
.......Demonstrate
Here we have a packet that is 1488, and its typically normal for a packet to have bytes in the 150 or below range per say. SO seing these bigger 
packets likes these that are carrying 1000+ bytes is of intrest to me. It even says "article" next to it so its obviously carry information about 
article. And you can even see the readable words in ASCII if you look down at the bottom right. And by the way i just want to say now that this is
essentially a discussion forum were people can discuss revelent topics that were discussed in the podcast which is called SecurityNow. 
You can look them up on Youtube and and learn a lot. But maybe our Flag might be in here in one of these larger packets, So lets click on the one
that has 1176 bytes.
.........Demonstrate and reveal the Flag




Step 3
..........read the 3rd hint
Now from reading this,... the clues that i can derive from this would be about the fact that the subject revolves around Mail and letters. and also it
highlights the letters DEB in debit card. My first thought that come to mind is email, however there is no SMTP protocol thats exists in this pcap file.
Because if we look at our hypothetical list that we created earlier we'll see that it's not on that list. And out of all the protocols that are on that 
list FTP would be my highest contender due to the fact that it works with retrieveing and sending files That could be figuratively interpreted as
a letter. and im not sure if you already saw  but there was FTP protocol, and ther was FTP-DATA protocol that exists in that pcap file. And the very 
fact there is protocol by the name FTP_DATA in the pcap means somebody definetly must have transfered some data to or from their device.
So lets quickly type FTP-DATA to see more info from it
..........Demonstrate
And as you can see,... its the server that is the one thats sending data packets to the host,... which means the host is downloading a file of somekind
from the server. And i want to know what file that is,... and if you look over at the info section you'll see the name and type of that file, which
in this case is a .deb file,....Hmmmmm sounds eerily similar to the hint that spoke about the kid finding a DEB-it card. with the DEB being noticibly 
highlighted. but i'll tell you right now if you double click on any of these packets it's not going to reveal the flag. You have a total of 360 packets
being displayed and theyre all pretty much similar. So opening up each one to look for the flag seems rather time consuming. Maybe you can find a way to
filter for it, and feel free to correct me if im wrong, but i dont feel like there is.
So with that being said lets go back and create a filter for only FTP.
...........Demonstrate
we see that there are only 95 packets being displayed.
And as we can can see everything seems to be rather scattered all over the place,.. so letes see if there is a way to group some of information thats
being showed. So lets click on info, and boom its a little more easier to se better. Here we can see the requests being made. We can see all the attempts
to change the working directoy CWD, and we see we can see another group called requesting to LIST, and another that says to Print working Directory PWD.
And here we see a request to retrieve (RETR) a file which is the same file we saw earlier that was being downloaded earlier.
And if you scroll down a few packets more you can see the flag,... Monkeys.exe
At the time of creating this CTF i notice now that i could have done this differently.
and if i were to go back and do it again. i would have filtered out the responses and replace the location of the flag to replace the name of the file
that was making the request for that file.

Step 4
...........read the 4th hint
From reading the hint we can see a handfull of clues being thrown at us. And the first one that sticks out to me is when it says tha the boy liked to 
his dad's fishing NET but my brother like to Tel on us,... notice how tel doesnt even include 2 Ls,... Net Tel,... TEL NET,... it's obviously trying to say
telnet. We also see that it's highlighting MUD., but i cant really make out what that is right now. And we also se the name that his cousin gives himself 
which is "The Courageous Paladin",... and notice how each letter at the start of each word is capitalized. And when you add them together it says TCP. SO 
now we Telnet and TCP. So with the information that we just got from theset 2 clues lets go back into wireshark and see what we can do.
Lets try typing in telnet.
oh no! nothing shows up,... thats weird. why would it give me a hint that it might be using telnet? im not going to bother trying to figure out why.
i guess we can just move on to the next clue and just type in tcp and see what happens. 
WOW! We got 4,020 packets displayed. Thats like 2/3drds of the entire pcap file. Thats weird. Lets look and try to figure out why.
Lets go ahead and clcik on the protocol tab to group things together. and scroll back up to the top
...........Show how there are different Protocols
Thats weird no other protocols should be displayed, because if i already specified TCP that means no other protocol should show up in my results.
So what gives , why is it doing this?
Well of course there is a reason for this and ill just be honest,..
i didnt spend a lot of time as much as i would have liked to, but from the little bit of research that i did do im just going to blanket the subject and say
a lot of other protocols rely on tcp in order to do its job,... which is why your seeing multiple protocols dispite the filter.
So what can we to reduce the number of packets out of this 4000?
well let me show you something. Lets go ahead and right click on any of these packets, doesnt matter which one. but im going to click on this ftp packet.
Youll go down and and go to "follow",... and then click on "TCP STream".
Another window will pop showing the entire conversation going on between these 2 Ips.
And if you look at the bottom left you can see that it says that it has 30 client PKs and 41 Server PKs. Which is a total of 71 pk.
And if you look over here You can see that this conversation/stream has been assigned a value by wireshark with the number 82.
So this conversation is the 82nd conversation that exists in this pacap. So its fair to say that there are at least 82 converstions/TCP streams that exists
in this pacp. And again i will just say that for every new converastion thats been assigned a value is a new ip that the host is communicating with.
So i want know how many conversations exists in total in this pcap.
i could filter out this specific TCPstream and reduce the number of packets by 71,... but thats not really a huge difference,... and it also seems like
a lot of work just to go through each TCP stream just to see if it might contain our flag.
So lets again try to see first how many TCP streams/converstaions exist in this pcap.
And we are going to do that by creating a new Column. If you can see we already have one that says "Time", Source, Destination, and etc. But this new
Column will basically show us which packets belong to which converstations by showing it's "Stream number" that it has been assigned. 
And not only that but we also need to create a new Column to reveal the source ports of each packet.
So lets click on edit,... Go to Preferences,... a new window will pop up and you want to click on columns.
And as you can see i already created 2 columns that are not currently selected.
But ill create one for demonstration purposes.
.........Demonstrate
But once you create your Column,... your going to want to make sure that its selected and then click on "okay".
And now that we have our new columns lets look at how many total converations are there.
Lets click the stream index to sort the numbers from least to greatest. and then again from greastest to least. You might have to scroll back to the top.
But as you can see there are a total of 102 conversations in this pcap.
Ill be honest this doesnt really help me, but it makes me feel more comforatable. The column however will help me group the conversations together when
i click on the column. i dont know i think it's really helpful.
but lets go ahead and look at our source ports,... you can see that its all kinda scattered. so lets go ahead and click on the column to make it easier
to look at. and then scroll back up to the top. There... that looks better.
but Notice by combining the "Stream Index" column and the "Source port column",... i can better be able to Distinguish,.... and recieve reasurance that
each packet that is connected to a port really is apart of that same conversation,... which we can see is revealed by the consistent stream number that
is being displayed of 82.
Since we still have 4020 packets being displayed,... lets continue to see what we can do to lower that amount.
lets look at the port number and just scroll down a bit.
................. Demonstrate how each port belongs to each protocol.
port 443 is https which we know is encrypted,... so lets say for example if we followed the tcp stream its not going to be helpful to us because we
won't beable to read anything if we do,... and if we continue to scroll down we can see that port 443 makes most of the packets in this pcap file,.. 
so we can just go ahead and filter out all ports with a Source or Destination of 443.
...........apply the filter.
And boom we now have 768 packets compared to the 4,000+ packets that we had before.
............scroll down to find weird port
UH OH,... 9999,... thats a not a normal port that you ever usually find,.... now im invested to see what going on here,... You can even see that theyre
all assigned to the same number for its tcp stream. so lets go ahead and right click and see its tcp stream.
............scroll and reveal the flag and talk about how it was using telnet on a different port and which is why wireshark didnt recognize the protocol.






dns.qry.name == "www.FLAG---{IN}.com"
dns.flags.response == 0 and dns.qry.type == 1

ftp.response.code == 150

tcp.srcport == 119

tcp.dstport == 9999
tcp.dstport == 9999 or tcp.srcport ==9999
tcp and !(ftp || ftp-data || nntp || http || tls)       and           !(tcp.srcport == 443 || tcp.dstport == 443)

